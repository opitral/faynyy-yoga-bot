import logging

from aiogram import Bot
from aiogram.enums import ParseMode
from aiogram.exceptions import TelegramBadRequest

from application.database import UserDatabase
from application.settings import settings


async def notify_admins(bot: Bot, message: str, parse_mode: ParseMode = ParseMode.MARKDOWN):
    for admin_telegram_id in settings.ADMINS_TELEGRAM_ID:
        try:
            await bot.send_message(admin_telegram_id, message, parse_mode=parse_mode, disable_web_page_preview=True)
        except TelegramBadRequest:
            logging.warning(f"Failed to send message to admin {admin_telegram_id}")


NOTIFICATIONS = [
    "–ö–æ–∂–Ω–æ–≥–æ –¥–Ω—è —Ç–∏ –º–∞—î—à 1140 —Ö–≤–∏–ª–∏–Ω –∂–∏—Ç—Ç—è‚è∞\n–¢–æ–º—É –∑–Ω–∞–π–¥–∏ 25 —Ö–≤–∏–ª–∏–Ω —ñ –ø—Ä–∏–¥—ñ–ª–∏ —ó—Ö —Å–≤–æ—î–º—É —Ç—ñ–ª—É —Ç–∞ –∑–¥–æ—Ä–æ–≤‚Äò—é",
    "–¢–∏ –º–∞—î—à —Ç—Ä–µ–Ω—É–≤–∞—Ç–∏ —Å–≤–æ—î —Ç—ñ–ª–æ, —â–æ–± –≤–æ–Ω–æ –Ω–µ –∑–∞–≤–∞–∂–∞–ª–æ —Ç–æ–±—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –ø–ª–∞–Ω–∏ –¥—É—à—ñü™¨",
    "–í —Ç–µ–±–µ –≤—Å–µ –≤–∏–π–¥–µ! –ù–∞–π—Ç—è–∂—á–µ –∑—Ä–æ–±–∏—Ç–∏ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫, –∞ –¥–∞–ª—ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –Ω–æ–≤–∏–π, —á—É–¥–æ–≤–∏–π —à–ª—è—Ö. üôèüèª",
    "–ü—Ä–∞–∫—Ç–∏–∫–∏ –ô–æ–≥–∏ —Ä–æ–±–ª—è—Ç—å —Ç–≤–æ—î —Ç—ñ–ª–æ –º–æ–ª–æ–¥–∏–º —Ç–∞ –∑–¥–æ—Ä–æ–≤–∏–º\n—ñ –ø–æ–∫—Ä–∞—â—É—é—Ç—å –ø–∞–º‚Äò—è—Ç—å —Ç–∞ —Ä–æ–±–æ—Ç—É –º–æ–∑–∫—Éüßòüèª‚Äç‚ôÇÔ∏è",
    "–ó–≤–µ—Ä–Ω–∏ —É–≤–∞–≥—É –Ω–∞ —Å–≤–æ—î –¥–∏—Ö–∞–Ω–Ω—è. –ü—Ä—è–º–æ –∑–∞—Ä–∞–∑ –∑—É–ø–∏–Ω–∏—Å—å,\n—ñ –≤—ñ–¥—á—É–π –∂–∏—Ç—Ç—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–µ–±–µü´Å\n–í—ñ–¥—á—É–π —è–∫ —Ç–∏ –¥–∏—Ö–∞—î—à",
    "–í—Å—ñ –ø—Ä–æ–±–ª–µ–º–∏ –Ω–µ —Ç—ñ–ª—å–∫–∏ –≤ –≥–æ–ª–æ–≤—ñ - –≤–æ–Ω–∏ —É —Ç—ñ–ª—ñ\n–£ –∫–æ–∂–Ω—ñ–π –∑ 30 —Ç—Ä–∏–ª—å–π–æ–Ω—ñ–≤ –∫–ª—ñ—Ç–∏–Ω —è–∫—ñ —î –≤ —Ç–æ–±—ñ\n–ñ–µ–Ω–∏ –≥–µ—Ç—å —Å—Ç—Ä–µ—Å —ñ –∞–ø–∞—Ç—ñ—é —ñ –ø—Ä–∞–∫—Ç–∏–∫—É–π",
    "–ú–µ–Ω—Ç–∞–ª—å–Ω–µ –∑–¥–æ—Ä–æ–≤‚Äò—è —Ç–∞–∫ —Å–∞–º–æ –≤–∞–∂–ª–∏–≤–µ —è–∫ —ñ —Ñ—ñ–∑–∏—á–Ω–µ.\n–ü—Ä–∞—Ü—é—î—à –Ω–∞–¥ —Ç—ñ–ª–æ–º - –ø–æ–∫—Ä–∞—â—É—î—à —Ä–æ–±–æ—Ç—É –º–æ–∑–∫—Éüß†",
    "–°—Ç—Ä–∞—Ö, —Å—Ç—Ä–µ—Å —ñ –∞–ø–∞—Ç—ñ—è.\n–ù–µ –¥–∞–≤–∞–π —Ü–∏–º —Å–ª–æ–≤–∞–º –∑–∞–≤–∞–∂–∞—Ç–∏ —Ç–æ–±—ñ –∂–∏—Ç–∏.\n–ü—Ä–∞–∫—Ç–∏–∫—É–π —ñ –ø–æ–∑–±—É–≤–∞–π—Å—è –Ω–µ–≥–∞—Ç–∏–≤—É –∑—ñ —Å–≤–æ–≥–æ –∂–∏—Ç—Ç—è",
    "–¢—ñ–ª—å–∫–∏ —É —Å–ø–æ–∫—ñ–π–Ω–æ–º—É —Ç–∞ —Å–ø—Ä–∏—è—Ç–ª–∏–≤–æ–º—É —Ä–æ–∑—É–º—ñ -\n–º–æ–∂–ª–∏–≤–æ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –≥–µ–Ω—ñ–∞–ª—å–Ω—ñ —ñ–¥–µ—óüòä",
    "–ó–∞–ª–∏—à—Ç–µ —É —Å–≤–æ—î–º—É –∂–∏—Ç—Ç—ñ —Ç—ñ–ª—å–∫–∏ —Ç–µ —â–æ –Ω–∞–¥–∏—Ö–∞—î –í–∞—Å\n—ñ –Ω–∞–ø–æ–≤–Ω—é—î –ï–Ω–µ—Ä–≥—ñ—î—é‚ö°Ô∏è\n–ó —É—Å—ñ–º —ñ–Ω—à–∏–º - –ø—Ä–æ—â–∞–π—Ç–µ—Å—å –±–µ–∑ –∂–∞–ª—é",
    "–ó–Ω–∞—Ö–æ–¥—å —Å–≤—ñ—Ç–ª–æ —É —Å–æ–±—ñ —Ç–∞ –ª–æ–≤–∏ —Å–≤—ñ–π –†–ò–¢–ú -\n–Ω–∞–≤—ñ—Ç—å –ø—ñ–¥ —á–∞—Å –ª—é—Ç–æ—ó –ø—ñ—Ç—å–º–∏ü§ç",
    "–¶—ñ–Ω—É–π –∫–æ–∂–µ–Ω —Å–≤—ñ–π –¥–µ–Ω—å,\n—Ü—ñ–Ω—É–π –∫–æ–∂–Ω—É —Ö–≤–∏–ª–∏–Ω—É —Å–≤–æ–≥–æ –∂–∏—Ç—Ç—è - —ñ —Ç–∏ –±—É–¥–µ—à —â–∞—Å–ª–∏–≤–∏–πüòä",
    "–¢–≤–æ—ó –º—Ä—ñ—ó –≤–∞–∂–ª–∏–≤—ñ - –ú–†–Ü–ô\n–†—É—Ö–∞–π—Å—è –≤–ø–µ—Ä–µ–¥, –¥—ñ–π, –¥–æ—Å—è–≥–∞–π, –∑–¥—ñ–π—Å–Ω—é–π‚ö°Ô∏è\n–ù–µ —Å–ª—É—Ö–∞–π —Ç–∏—Ö —Ö—Ç–æ –∫–∞–∂–µ –Ω–µ–≥–∞—Ç–∏–≤ –ø—Ä–æ —Ç–µ–±–µ\n–ü—Ä–∞–∫—Ç–∏–∫—É–π —â–æ–± —Å—Ç–∞—Ç–∏ —Å–∏–ª—å–Ω–∏–º —Ç–∞ –Ω–∞–ø–æ–≤–Ω–µ–Ω–∏–º",
    "–ú–∏ –ø—Ä–∞–≥–Ω–µ–º–æ –õ—é–±–æ–≤—ñ, –®—É–∫–∞—î–º–æ –ß–∞—Å—É —ñ –±–æ—ó–º–æ—Å—è –°–º–µ—Ä—Ç—ñü•∫\n–ë—É–¥—å —Å–∏–ª—å–Ω–∏–º —ñ –Ω–µ–∑–ª–∞–º–Ω–∏–º —Ä–∞–∑–æ–º –∑ –π–æ–≥–æ—é",
    "–Ü–¥–µ–∞–ª—å–Ω–æ—Å—Ç—ñ –Ω–µ —ñ—Å–Ω—É—î - —Ç–∏ —Ç–∞–∫–∏–π —è–∫–∏–π —îü§ç\n–Ü –≤ —Ü—å–æ–º—É —Ç–≤–æ—è —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å",
    "–ü—Ä–∏–π–º–∏ —Å–µ–±–µ –∑—ñ –≤—Å—ñ–º–∞ –Ω–µ–¥–æ–ª—ñ–∫–∞–º–∏\n–®–ª—è—Ö —Ä–æ–∑–≤–∏—Ç–∫—É –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –ª—é–±–æ–≤—ñ –¥–æ —Å–µ–±–µ, –∞ –Ω–µ –∑ –∫—Ä–∏—Ç–∏–∫–∏",
    "–î–æ–∑–≤–æ–ª—å —Å–æ–±—ñ –ø–∞–¥–∞—Ç–∏üôèüèª\n–î–æ–∑–≤–æ–ª—å —Å–æ–±—ñ –¥–æ–ø—É—Å–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏\n–ù–µ –±—ñ–π—Å—è –∑–¥–∞–≤–∞—Ç–∏—Å—è\n–í—Å–µ —â–æ –∑–∞—Ä–∞–∑ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è - —Ü–µ —à–ª—è—Öüòä\n–ë–µ–∑ –ø–æ—Ä–∞–∑–æ–∫ - –Ω–µ–º–∞—î —É—Å–ø—ñ—Ö—É.",
    "–ù–µ –≤–∞—Ä—Ç–æ –∑–∞—Ü–∏–∫–ª—é–≤–∞—Ç–∏—Å—è –Ω–∞ —Ç–æ–º—É —á–æ–≥–æ –≤–∞–º –±—Ä–∞–∫—É—î -\n–Ω–µ –∑–∞–±—É–≤–∞–π—Ç–µ –Ω–∞—Å–æ–ª–æ–¥–∂—É–≤–∞—Ç–∏—Å—è —Ç–∏–º —â–æ –º–∞—î—Ç–µ.",
    "–ì–æ–¥—ñ —Ö–≤–∏–ª—é–≤–∞—Ç–∏—Å—è –∑–∞ —Ç–µ —â–æ –í–ò –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µüôèüèª\n–†–æ–∑—Å–ª–∞–±—Ç–µ—Å—å. –ü—Ä–∞–∫—Ç–∏–∫–∏ –π–æ–≥–∏ –¥–æ–ø–æ–º–æ–∂—É—Ç—å –≤ —Ü—å–æ–º—É.",
    "–¶–µ —Ç–µ–∂ –º–∏–Ω–µüòä\n–¢–æ–±—ñ –ø–æ–≥–∞–Ω–æ, —Ä–æ–∑–ª—é—Ç–∏–≤—Å—è, –∑–ª–∏—à—Å—è, –Ω–µ –∑–Ω–∞—î—à —â–æ —Ä–æ–±–∏—Ç–∏.\n–ü—Ä–∞–∫—Ç–∏–∫—É–π. –Ü —Ç–∏ –≤—ñ–¥—á—É—î—à –∫–∞–π—Ñ —Ç–∞ –µ–Ω–µ—Ä–≥—ñ—é –¥–ª—è –∂–∏—Ç—Ç—è —Ç–∞ –¥—ñ–π‚ö°Ô∏è"
]

async def daily_notify(bot: Bot, db: UserDatabase):
    users = db.get_all_users_with_notifications()
    logging.info(users)
    for user in users:
        try:
            await bot.send_message(chat_id=user["telegram_id"], text=NOTIFICATIONS[user["next_notification_index"]])
            db.update_user_field(user["telegram_id"], "next_notification_index", user["next_notification_index"] + 1)
        except TelegramBadRequest as e:
            logging.warning(f"Failed to send message to user {user['telegram_id']}: {e}")
